# CLAUDE.md - NGX Studio

## Project Overview

NGX Studio is an AI-powered interface builder that generates React widgets via natural language using Google's Gemini 2.5 Flash API. The application provides a visual studio environment where users can describe widgets in natural language (Spanish) and see live previews of the generated components.

**Primary use case:** Creating fitness and health tracking UI widgets (workout cards, meal plans, hydration trackers, etc.)

## Tech Stack

- **Framework:** React 19 with TypeScript
- **Build Tool:** Vite 6
- **Styling:** Tailwind CSS (via CDN)
- **Icons:** lucide-react
- **AI Integration:** Google Gemini 2.5 Flash (`@google/genai`)
- **Module System:** ES Modules with import maps

## Project Structure

```
ngx_A2UI_studio-/
├── App.tsx                    # Main application component with chat UI
├── index.tsx                  # React entry point
├── index.html                 # HTML template with Tailwind CDN & import maps
├── types.ts                   # TypeScript type definitions
├── constants.ts               # Colors, system prompt, template library
├── vite.config.ts             # Vite configuration
├── tsconfig.json              # TypeScript configuration
├── package.json               # Dependencies and scripts
├── metadata.json              # App metadata for AI Studio
├── components/
│   ├── WidgetRenderer.tsx     # Widget components and A2UIMediator
│   └── UIComponents.tsx       # Shared UI primitives (GlassCard, etc.)
└── services/
    └── geminiService.ts       # Gemini API integration service
```

## Key Commands

```bash
# Install dependencies
npm install

# Start development server (port 3000)
npm run dev

# Build for production
npm run build

# Preview production build
npm run preview
```

## Environment Variables

Create a `.env.local` file with:
```
GEMINI_API_KEY=your_api_key_here
```

The API key is loaded via Vite's `loadEnv` and exposed as `process.env.API_KEY`.

## Architecture Overview

### Widget System

The application uses a mediator pattern for rendering widgets dynamically:

1. **WidgetPayload** - JSON structure with `type`, `props`, and optional `thought`
2. **A2UIMediator** (`components/WidgetRenderer.tsx:273`) - Maps widget type strings to React components
3. **Widget Components** - Individual components like `WorkoutCard`, `MealPlan`, `HydrationTracker`

### Available Widget Types

| Type | Description | Key Props |
|------|-------------|-----------|
| `workout-card` | Exercise routine display | `title`, `category`, `duration`, `exercises[]`, `coachNote` |
| `meal-plan` | Nutrition schedule | `totalKcal`, `meals[]` |
| `hydration-tracker` | Water intake tracker | `current`, `goal` |
| `progress-dashboard` | Metrics overview | `title`, `progress`, `metrics[]` |
| `today-card` | Daily summary | `greeting`, `date`, `mainSession` |
| `supplement-stack` | Supplement checklist | `items[]` |
| `max-rep-calculator` | 1RM calculator | `weight`, `reps` |
| `alert-banner` | Notification banner | `type`, `message` |
| `coach-message` | Coach communication | `coachName`, `timestamp`, `message` |
| `exercise-row` | Single exercise display | `name`, `currentSet`, `totalSets`, `load`, `reps` |
| `metric-card` | Single metric display | `label`, `value`, `unit`, `trend` |
| `season-timeline` | Training phase timeline | `seasonName`, `phases[]` |
| `insight-card` | AI insight display | `message` |

### Shared UI Components

Located in `components/UIComponents.tsx`:
- **GlassCard** - Glassmorphism card container with border glow
- **AgentBadge** - Widget attribution badge (e.g., "Generated by BLAZE")
- **ProgressBar** - Animated progress indicator
- **ActionButton** - Primary/secondary action buttons

### Color System

Defined in `constants.ts` - uses a consistent color palette with semantic names:
- `nexus` (#6D00FF) - Primary purple
- `blaze` (#FF4500) - Training/workout orange
- `aqua` (#00D4FF) - Hydration blue
- `macro` (#FF6347) - Nutrition red
- Plus many more for different widget contexts

## Gemini API Integration

The `GeminiService` (`services/geminiService.ts`) handles AI generation:

1. Receives natural language prompt
2. Sends to Gemini 2.5 Flash with system prompt from `constants.ts`
3. Returns JSON widget configuration with `responseMimeType: "application/json"`
4. Falls back to mock response if no API key is configured

**System Prompt:** Located in `constants.ts:24-49`, defines available widget types and generation rules in Spanish.

## Development Conventions

### Code Style
- TypeScript with explicit type annotations
- Functional React components with hooks
- Spanish UI text (prompts, labels, system messages)
- Tailwind utility classes for styling (not CSS modules)

### Component Patterns
- Props interfaces defined inline or in `types.ts`
- Widget components receive `data` and optional `onAction` callback
- Use `GlassCard` wrapper for consistent widget styling
- Use `AgentBadge` to show which "agent" generated the widget

### State Management
- Local React state with `useState` hooks
- No external state management library
- JSON editor state synced with preview

### Adding New Widgets

1. Add type definition to `SYSTEM_PROMPT` in `constants.ts`
2. Create component in `components/WidgetRenderer.tsx`
3. Register in `widgetMap` object in `A2UIMediator`
4. Optionally add template in `TEMPLATE_LIBRARY`

## UI Layout

The app has a three-panel layout:
1. **Sidebar (left)** - Spaces navigation and template library
2. **Chat + Editor (center-left)** - Chat history, input, and JSON editor
3. **Preview (right)** - Live phone frame preview of widgets

## Path Aliases

Configured in both `tsconfig.json` and `vite.config.ts`:
```
@/* -> ./*
```

## Important Notes for AI Assistants

1. **Language:** UI text and system prompts are in Spanish
2. **No tests:** Project has no test setup - be careful with changes
3. **CDN dependencies:** Tailwind CSS is loaded via CDN, not npm
4. **Import maps:** Browser dependencies use ES modules import map in `index.html`
5. **Mock mode:** App works offline with mock responses when no API key is set
6. **Widget JSON:** Always validate JSON structure before rendering
7. **Type safety:** All widget props should match expected interfaces
